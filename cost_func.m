function J = cost_func(stage, x, u,dmv, param)
%     err = ([x([1:3, 13:15])', (eul2rotm([x(9), x(8), x(7)])*normalize([x(4), x(5), x(6)], 'norm')')', (eul2rotm([x(21), x(20), x(19)])*normalize([x(16), x(17), x(18)], 'norm')')']'-param);
   
err = (x([1:3,13:15,7:9,  19:21])-param);
        Q =[1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
            0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
            0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
            0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;...
            0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;...
            0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;...
            0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0;...
            0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0;...
            0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0;...
            0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0;...
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0;...
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10];
%     err_tot = (err'*Q*err);
err_tot = err'*Q*err + dmv'*dmv*.01;
% if stage == 6
%     err_tot = err'*err*3;
%     end
% if stage == 11
%     J = err_tot*100;
% elseif stage < 3
     J = err_tot;
% else
%     J = err_tot+ dmv'*dmv*100;
% end

%      end
end